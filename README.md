# Toxic Comment Classification

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ (Multi-label text classification). –ú–æ–¥–µ–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ –∫ –æ–¥–Ω–æ–º—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∏–∑ 6 –∫–ª–∞—Å—Å–æ–≤: `toxic`, `severe_toxic`, `obscene`, `threat`, `insult`, `identity_hate`.

## üìä –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏–∑ –í–∏–∫–∏–ø–µ–¥–∏–∏, —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–µ –ª—é–¥—å–º–∏ –ø–æ —É—Ä–æ–≤–Ω—é —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏.
–¶–µ–ª–µ–≤—ã–µ –º–µ—Ç–∫–∏:
*   Toxic (–¢–æ–∫—Å–∏—á–Ω—ã–π)
*   Severe Toxic (–°–∏–ª—å–Ω–æ —Ç–æ–∫—Å–∏—á–Ω—ã–π)
*   Obscene (–ù–µ–ø—Ä–∏—Å—Ç–æ–π–Ω—ã–π)
*   Threat (–£–≥—Ä–æ–∑–∞)
*   Insult (–û—Å–∫–æ—Ä–±–ª–µ–Ω–∏–µ)
*   Identity Hate (–ù–µ–Ω–∞–≤–∏—Å—Ç—å –ø–æ –ø—Ä–∏–∑–Ω–∞–∫—É –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏)

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –º–µ—Ç–æ–¥—ã

*   **Python 3.x**
*   **Pandas / NumPy**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
*   **Scikit-learn**:
    *   `TfidfVectorizer`: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ –≤–µ–∫—Ç–æ—Ä—ã (TF-IDF).
    *   `LogisticRegression`: –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å (Solver: liblinear).
    *   `OneVsRestClassifier`: –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –º–Ω–æ–≥–æ–º–µ—Ç–æ—á–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–æ–±—É—á–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞).
    *   `Pipeline`: –ü–∞–π–ø–ª–∞–π–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ–±—É—á–µ–Ω–∏—è.
*   **Matplotlib**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –º–µ—Ç—Ä–∏–∫.
*   **SHAP**: –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –º–æ–¥–µ–ª–∏ (Feature Importance).

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã (–≤ Notebook)

1.  **EDA (Exploratory Data Analysis)**: –ê–Ω–∞–ª–∏–∑ –±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤.
2.  **–ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥**: –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ (—É–¥–∞–ª–µ–Ω–∏–µ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤, –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É).
3.  **–û–±—É—á–µ–Ω–∏–µ (Baseline)**: TF-IDF + –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è.
4.  **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫.
5.  **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–æ–≤ (Threshold Tuning)**: –ü–æ–¥–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ F1-score.
6.  **FastText + –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ FastText –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞.
7. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è FastText –º–æ–¥–µ–ª–∏**: –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ—Ä–æ–≥–∞–º–∏.
8.  **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**:
    *   –ê–Ω–∞–ª–∏–∑ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏ (Top features).
    *   –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ SHAP.

---



## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
toxic_text/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ train.csv          # –û–±—É—á–∞—é—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç
‚îÇ   ‚îî‚îÄ‚îÄ test.csv           # –¢–µ—Å—Ç–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ preprocess_data.py # –§—É–Ω–∫—Ü–∏–∏ –æ—á–∏—Å—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞ (clean_text, preprocess_data)
‚îÇ   ‚îú‚îÄ‚îÄ utilits.py         # –£—Ç–∏–ª–∏—Ç—ã (metrics_model, explain_text, applay_trasholds)
‚îÇ   ‚îî‚îÄ‚îÄ find_optimal_threshold.py  # –ü–æ–∏—Å–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø–æ—Ä–æ–≥–æ–≤
‚îú‚îÄ‚îÄ test.ipynb             # –û—Å–Ω–æ–≤–Ω–æ–π notebook —Å –ø–æ–ª–Ω—ã–º pipeline
‚îî‚îÄ‚îÄ README.md
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–µ–π

### TF-IDF + Logistic Regression (Baseline)
- **ROC-AUC**: ~0.97
- F1 Score (macro): 0.5918
- F1 Score (micro): 0.7144
- Accuracy: 0.9094
- Precision: 0.3888
- Recall: 0.6129
### FastText + Logistic Regression
- **ROC-AUC**: ~0.82
- F1 Score (macro): 0.2561
- F1 Score (micro): 0.3425
- Accuracy: 0.8285
- Precision: 0.1062
- Recall: 0.3038
---

## üí° –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- Baseline –º–æ–¥–µ–ª—å —Å ROC-AUC 0.96+
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
- –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (—Ç–æ–ø–æ–≤—ã–µ —Ç–æ–∫—Å–∏—á–Ω—ã–µ/–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞)
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π (TF-IDF –∏ FastText)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SHAP –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏

üîÑ **–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ BERT –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (SMOTE)
- –ü–æ–∏—Å–∫ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (GridSearchCV)

---



## üìö –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Kaggle Toxic Comment Classification](https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge)
- [Scikit-learn Multi-label Classification](https://scikit-learn.org/stable/modules/multiclass.html)
- [Gensim FastText](https://radimrehurek.com/gensim/models/fasttext.html)
- [SHAP Documentation](https://shap.readthedocs.io/)

---

## üìä –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏

- **ROC-AUC**: –û–±—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏
- **F1-score (Macro)**: –°—Ä–µ–¥–Ω–µ–µ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º
- **Precision**: –î–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Å—Ä–µ–¥–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö
- **Recall**: –î–æ–ª—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤


---

## ü§ù –í–∫–ª–∞–¥

–≠—Ç–æ –ª–∏—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

