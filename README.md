# Toxic Comment Classification

–ü—Ä–æ–µ–∫—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ (Multi-label text classification). –ú–æ–¥–µ–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ –∫ –æ–¥–Ω–æ–º—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∏–∑ 6 –∫–ª–∞—Å—Å–æ–≤: `toxic`, `severe_toxic`, `obscene`, `threat`, `insult`, `identity_hate`.

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–µ–π

| –ú–æ–¥–µ–ª—å | ROC-AUC | F1 (macro) | F1 (micro) | Precision | Recall |
|--------|---------|------------|------------|-----------|--------|
| BERT + LogReg | 0.977 | 0.60 | 0.71 | 0.40 | 0.63 |
| **TF-IDF + LogReg** | **0.972** | 0.59 | 0.71 | 0.39 | 0.61 |
| **BiLSTM + FastText** | **0.98** | 0.61 | 0.75 | 0.42 | 0.63 |
| FastText + LogReg | 0.82 | 0.26 | 0.34 | 0.11 | 0.30 |

*BiLSTM —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

##  –í—ã–≤–æ–¥—ã

TF-IDF –∑–∞–¥–∞–ª –æ—á–µ–Ω—å –≤—ã—Å–æ–∫—É—é –±–∞–∑–∞–≤—É—é –ø–ª–∞–Ω–∫—É (AUC ~0.97), –¥–æ–∫–∞–∑–∞–≤, —á—Ç–æ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å –Ω–∞ 90% –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–ª–æ–≤-—Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å, –∞ —É–∂–µ –≤–æ –≤—Ç–æ—Ä—É—é —Å–ª–æ–∂–Ω—ã–º—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º.

–û–¥–Ω–∞–∫–æ –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫–∞–∑–∞–ª–∞ BiLSTM, —É—Å—Ç—Ä–∞–Ω–∏–≤ –≥–ª–∞–≤–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É –ø—Ä–æ—Å—Ç—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤: –ø—Ä–∏ –æ–±—ã—á–Ω–æ–º —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–∏ (Mean Pooling) –≤–µ–∫—Ç–æ—Ä –æ–¥–Ω–æ–≥–æ —Ä—É–≥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ —Ç–µ—Ä—è–ª—Å—è –≤ –¥–ª–∏–Ω–Ω–æ–º —Ç–µ–∫—Å—Ç–µ, –∞ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —Å–µ—Ç—å —Å–º–æ–≥–ª–∞ –≤—ã–ª–æ–≤–∏—Ç—å —ç—Ç–æ—Ç —Å–∏–≥–Ω–∞–ª –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. BERT (–±–µ–∑ —Ñ–∞–π–Ω-—Ç—é–Ω–∏–Ω–≥–∞) –ø–æ–∫–∞–∑–∞–ª —Å—Ö–æ–∂–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –Ω–æ –æ–∫–∞–∑–∞–ª—Å—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–∏–º –¥–ª—è –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä–∞—è —Ç–∞–∫ —Ö–æ—Ä–æ—à–æ —Ä–µ—à–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ TF-IDF + LogReg.

## üìä –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö [Jigsaw Toxic Comment Classification](https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge) —Å–æ–¥–µ—Ä–∂–∏—Ç ~160k –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏–∑ –í–∏–∫–∏–ø–µ–¥–∏–∏, —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –ø–æ 6 –∫–ª–∞—Å—Å–∞–º —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏.

**–î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤**: ~90% –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ ‚Äî –Ω–µ—Ç–æ–∫—Å–∏—á–Ω—ã–µ. –ö–ª–∞—Å—Å—ã `threat` –∏ `severe_toxic` –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –æ—Å–æ–±–µ–Ω–Ω–æ —Ä–µ–¥–∫–æ, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ (–≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤, –ø–æ–¥–±–æ—Ä –ø–æ—Ä–æ–≥–æ–≤).

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã |
|-----------|-------------|
| ML/DL | PyTorch, Scikit-learn, Transformers (BERT) |
| NLP | TF-IDF, FastText, Gensim |
| –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è | SHAP |
| –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | Matplotlib |

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
toxic_text/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ train.csv              # –û–±—É—á–∞—é—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç
‚îÇ   ‚îî‚îÄ‚îÄ test.csv               # –¢–µ—Å—Ç–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ BiLSTM.py              # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ BiLSTM –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ FastTextVectorizer.py  # Sklearn-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π FastText
‚îÇ   ‚îú‚îÄ‚îÄ loader.py              # PyTorch Dataset –∏ DataLoader
‚îÇ   ‚îú‚îÄ‚îÄ train_LSTM.py          # –¶–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è LSTM
‚îÇ   ‚îú‚îÄ‚îÄ preprocess_data.py     # –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ find_optimal_threshold.py  # –ü–æ–¥–±–æ—Ä –ø–æ—Ä–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ utils.py               # –ú–µ—Ç—Ä–∏–∫–∏, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ shap_show.py           # SHAP-–∞–Ω–∞–ª–∏–∑
‚îú‚îÄ‚îÄ main.ipynb                 # TF-IDF, FastText —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ lstm.ipynb                 # BiLSTM —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ bert_tox_class.ipynb       # BERT —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

## üîé –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π

### TF-IDF: –¢–æ–ø —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
–ú–æ–¥–µ–ª—å —è–≤–Ω–æ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: `fuck`, `shit`, `idiot`, `stupid` –∏–º–µ—é—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞.

### FastText: –í–∫–ª–∞–¥ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
–ú–æ–¥–µ–ª—å –Ω–∞ FastText –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ, –∞ –Ω–µ —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å–ª–æ–≤. –§—É–Ω–∫—Ü–∏—è `word_contributions()` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∫–ª–∞–¥ –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏.

### SHAP-–∞–Ω–∞–ª–∏–∑
–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.


## üìö –†–µ—Å—É—Ä—Å—ã

- [Kaggle Competition](https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge)
- [Scikit-learn Multi-label Classification](https://scikit-learn.org/stable/modules/multiclass.html)
- [Gensim FastText](https://radimrehurek.com/gensim/models/fasttext.html)
- [SHAP Documentation](https://shap.readthedocs.io/)
- [Hugging Face Transformers](https://huggingface.co/docs/transformers/)

---

**–ê–≤—Ç–æ—Ä**: –õ–∏—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

